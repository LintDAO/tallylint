## Canister deploy on ic-chain and update
deploy on ic-chain doc :  
https://internetcomputer.org/docs/current/tutorials/deploy_sample_app#what-this-does
```bash
# 第一次部署到主网收费 1TC
dfx deploy --network ic --with-cycles 1000000000000
# 查询自己还有多少 cycles
dfx wallet --network ic balance
```




以后修改了代码要升级不用重新deploy指令,  
使用 upgrade指令, 要收费   
升级罐子指南:  
https://internetcomputer.org/docs/current/developer-docs/backend/motoko/upgrading  

cycles的收费规则:  
https://internetcomputer.org/docs/current/developer-docs/gas-cost

```bash
# 另外如果只执行 
dfx deploy
# 隐藏默认参数 --netwrok local . 就 不管有没有部署到ic主网上,都可以输入这个本地测试.

```



```
1 000 000 000 000
```

第一次部署到主网的前后端地址:
  Frontend canister via browser
    assets: https://x63j6-hqaaa-aaaal-acyoa-cai.icp0.io/
  Backend canister via Candid interface:
    vote1_backend: https://a4gq6-oaaaa-aaaab-qaa4q-cai.raw.icp0.io/?id=xz2pk-kiaaa-aaaal-acyoq-cai


```
# 生成后端文件供罐子使用: 
dfx deploy vote1_backend
# frontend
dfx deploy assets

#maybe used
npm install
npm run build

dfx start --clean 
```

todo:可能的依赖项: dfx.json  

```
 "vote1_frontend": {
      "dependencies": [
        "vote1_backend"
      ],
      "frontend": {
        "entrypoint": "src/vote1_frontend/src/index.html"
      },
      "source": [
        "src/vote1_frontend/assets",
        "dist/vote1_frontend/"
      ],
      "type": "assets"
    }
```

前端:  
依赖项管理:
package-lock.json 文件为 build自动生成.会覆盖package.json 的config  
ic-agent-js:
https://www.npmjs.com/search?q=dfinity

 如果要让前端更新过后的 依赖项生效,可能需要删除 lock文件,他自己会再生成  

 然后:  
 ```bash
 npm list
 ```


 ## 网络问题的排查(按步骤):     
 工具有多种可以选,比如wireshark .像是network的IDE.复杂强大  
 或者直接命令行小工具,简洁  
 1. DNS 是否被篡改和污染. 给予了错误的IP地址
```bash
nslookup raw.githubusercontent.com
Server:         172.23.0.1
Address:        172.23.0.1#53

Non-authoritative answer:
Name:   raw.githubusercontent.com
Address: 0.0.0.0
Name:   raw.githubusercontent.com
Address: ::
# 直接瞬间反应.且给了错误的地址!
```
修复DNS:  
```bash
# WSL的方法:其他的linux可能类似,有些许不同.
cat /etc/resolv.conf
# output:
# This file was automatically generated by WSL. To stop automatic generation of this file, add the following entry to /etc/wsl.conf:
# [network]
# generateResolvConf = false
# nameserver 172.23.0.1  
# 上面这个默认一般是用的宿主机的DNS服务器
# <<<<修改 DNS server>>>> 即这里的nameserver 域名服务
# 可选google 8888 cloudfare 1111 等...


```
 2. 得到了正确的IP 是否被禁止访问

 ```bash
 ping x.x.x.x
#   The ping command sends ICMP echo request packets directly to the specified IP address and 
# *does not use the HTTP or HTTPS protocols !*
# 
curl -v -o test.json https://sdk.dfinity.org/manifest.json
 
 ```
## Todo:   LICENSE 的选择

 ![Alt text](/assets_for_doc/image.png)


 ## Ref
 use ic-ledger-api demo:
 https://github.com/ielashi/icp-accountant

 fee:
 https://wiki.internetcomputer.org/wiki/Exchange_rate_canister

discus on tax report: 
 https://forum.dfinity.org/t/tax-reports-on-internet-computer/22356/6

 leger账本简介:  
 https://internetcomputer.org/docs/current/developer-docs/integrations/ledger/  
 Ledger canister  
 https://internetcomputer.org/docs/current/references/ledger  
 dfx ledger命令  
 https://internetcomputer.org/docs/current/developer-docs/integrations/ledger/interact-with-ledger  
 本地leger模拟:  
 https://internetcomputer.org/docs/current/developer-docs/integrations/ledger/ledger-local-setup  

Crypto tax reports in under 20 minutes:  
https://koinly.io/  
Koinly calculates your cryptocurrency taxes and helps you reduce them for next year. Simple & Reliable.  

PwC Annual 
Global Crypto 
Tax Report 2022
https://www.pwc.com/gx/en/financial-services/pdf/global-crypto-tax-report-2022.pdf  

How to Report Crypto on Your Taxes (Step-By-Step)
https://coinledger.io/blog/how-to-report-cryptocurrency-on-taxes


Tax reporting in the age of cryptocurrency
Getting ready for cryptocurrency tax regulation
https://www2.deloitte.com/us/en/pages/tax/articles/cryptocurrency-tax-reporting.html

tax rule of IRS
![Alt text](/assets_for_doc/image2.png)